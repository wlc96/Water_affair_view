<!DOCTYPE html>
<html>

	<head>
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<!-- Bootstrap core CSS -->
		<link href="public/bootstrap.min.css" title="" rel="stylesheet" />
		<link rel="stylesheet" href="css/plugins/toastr/toastr.min.css" />
		<link href="font-awesome/css/font-awesome.min.css" rel="stylesheet">
		<link href="public/animate.css" rel="stylesheet">
		<link rel="stylesheet" href="public/inspinia.css" />
		<!-- <link rel="stylesheet" href="css/my_TiBaoJiLu.css" /> -->
		<link href="css/plugins/dataTables/datatables.min.css" rel="stylesheet">
		<link rel="stylesheet" href="public/public.css">
		<link href="css/plugins/datetimepicker/bootstrap-datetimepicker.min.css" rel="stylesheet" media="screen">

		<link href="css/plugins/clockpicker/clockpicker.css" rel="stylesheet">
		<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
		<!--[if lt IE 9]>
		    <script src="public/html5shiv.min.js"></script>
		    <script src="public/respond.min.js"></script>
		<![endif]-->
		<title>设备详情</title>
		<style>
			.input-group{
			 	width: 174px;
			 	float: right;
			}
			.modal-body .form-group .input-append .form-control{
			 	width: 138px;
				margin-right: 0;
			}
			span.line{
			 	width: 18px;
			 	float: right;
			}
			.addFile{
				width: 118px;
				height: 118px;
				border:1px solid #e5e5e5;
				float: left;
				cursor: pointer;
				text-align: center;
				border-radius: 4px;
			}
			.addFile img{
				width: 60px;
				height: 60px;
			}
			.modal-body .form-group.disabledState label{
				color:#d2d2d2;
			}
			.clockpicker-popover{
				z-index: 3000;
			}
			.fa-clock-o{
				color:#999;
			}
			.jiJiaBox{
				width: 380px;
				float: right;
				margin-right: 110px;
				color: #999;
				border-radius: 3px;
				resize: none;
				border:1px solid #e5e6e7;
				position: relative;
			}
			.modal-body .form-group .jiJiaBox .form-control{
				border:none;
				width: 378px;
				margin-right: 0;
			}
			.jiJiaBox span{
				position: absolute;
				right:10px;
				top:10px;
			}
			.loadingBox{
				text-align: center;
				margin-top:20px;
				display: none;
			}
			.loadImg{
				position: relative;
				top:-2px;
				margin-right: 5px;
			}
			.modal-body .form-group .addFile{
				position: relative;
			}
			.modal-body .form-group .addFile .addImg{
				display: inline-block;
				width: 100%;
				height: 100%;
				outline: none;
			}
			.modal-body .form-group .addFile img{
				position: absolute;
				top:28px;
				left:28px;
			}
			.addFile {
            position: relative;
            display: inline-block;
            overflow: hidden;
        }

        .addFile input{
            position: absolute;
            left: 0px;
            top: 0px;
			bottom:0;
			right:0;
            opacity: 0;
            -ms-filter: 'alpha(opacity=0)';
			font-size: 200px;
			z-index: 111;
        }
		.jiJiaType>li{
			display: none;
		}
		.jiJiaType>li.show{
			display: block;
		}
		</style>
	</head>

	<body>
		<div id="wrapper">
			<!--标编辑-->
			<div id="biaobj" class=" wrapper wrapper-content animated fadeInRight" style="padding-top:0;">
				<div class="topIns">
					<ul class="insList">
						<li class="left">
							<div class="lBox">
								<img src="img/kfImg.png" alt="">
							</div>
							<div class="rBox">
								<a class="editBtn diaBtn" data-toggle="modal" data-target="#myModal"><img src="img/edit.png" alt=""></a>
								<h3 class="name">-</h3>
								<p>分布区地址：<span class="address">-</span></p>
								<ul>
									<li>
										<img src="img/dp.png" alt="">
										营业状态：<span class="statusCon">-</span>
									</li>
									<li>
										<img src="img/clock.png" alt="">
										营业时间：<span class="business_hours">-</span>
									</li>
									<li>
										<img src="img/tel.png" alt="">
										客服电话：<span class="phone">-</span>
									</li>
								</ul>
							</div>
						</li>
						<li class='middle'>
							<span class="line lr"></span>
							<p class="total">水表总数<span class="eq_sum">14</span>（个）</p>
							<p class="sbType">
								<span><img src="img/big.png" alt="">大口径水表：<span class="big_eq_sum">-</span></span>
								<span><img src="img/small.png" alt="">小口径水表：<span class="lit_eq_sum">-</span></span>
							</p>
							<ul>
								<li>
									<span class="green"></span>
									正常：<span class="open_num">-</span>
								</li>
								<li>
									<span class="red"></span>
									异常：<span class="fault_num">-</span>
								</li>
								<li>
									<span class="gray"></span>
									离线：<span class="Off_line_num">-</span>
								</li>
							</ul>
							<span class="line rt"></span>
						</li>
						<li class="right">
							<a class="editBtn diaBtn ceshi" data-toggle="modal" data-target="#myModal1"><img src="img/edit.png" alt=""></a>
							<p>当前水价计费类型：<span>阶梯计价</span></p>
							<ul class="jiJiaType">
								<li class="jieti">第一阶梯：<span class="first_order">-</span>元/m³</li>
								<li class="jieti">第二阶梯：<span class="second_order">-</span>元/m³</li>
								<li class="jieti">最大价格：<span class="third_order">-</span>元/m³</li>
								<li class="tongyi">统一价格：<span class="first_order">-</span>元/m³</li>
							</ul>
						</li>
					</ul>
				</div>
				<!-- 水表卡片视图 -->
				<div class="meterBox">
					<ul class="meterList">
						<!-- <li>
							<div class="ltBox">
								<img src="img/meter.png" alt="">
								<p class="kouJing">口径：15mm</p>
								<p class="state">状态：<span class="normal">正常</span></p>
							</div>
							<div class="rtBox">
								<h3>水表：LYJT-18120700018</h3>
								<ul>
									<li>
										<img src="img/water.png" alt="">
										累计用水量：<span>198.2吨</span>
									</li>
									<li class="noImg">
										当期用水量：<span>20.00吨</span>
									</li>
									<li class="noImg">
										剩&nbsp;余&nbsp;水&nbsp;量：<span>11.00吨</span>
									</li>
									<li>
										<img src="img/money.png" alt="">
										当&nbsp;前&nbsp;余&nbsp;额：<span>12.22元</span>
									</li>
								</ul>
								<button type="button" class="handle" data-toggle="modal" data-target="#myModal2">操作</button>
							</div>
						</li>
						<li>
							<div class="ltBox">
								<img src="img/meter.png" alt="">
								<p class="kouJing">口径：15mm</p>
								<p class="state">状态：<span class="abnormal">异常</span></p>
							</div>
							<div class="rtBox">
								<h3>水表：LYJT-18120700018</h3>
								<ul>
									<li>
										<img src="img/water.png" alt="">
										累计用水量：<span>198.2吨</span>
									</li>
									<li class="noImg">
										上月用水量：<span>20.00吨</span>
									</li>
									<li>
										<img src="img/money.png" alt="">
										应&nbsp;缴&nbsp;金&nbsp;额：<span>12.22元</span>
									</li>
								</ul>
								<button type="button" class="handle" data-toggle="modal" data-target="#myModal2">操作</button>
							</div>
						</li>
						<li>
							<div class="ltBox">
								<img src="img/meter.png" alt="">
								<p class="kouJing">口径：15mm</p>
								<p class="state">状态：<span class="offline">离线</span></p>
							</div>
							<div class="rtBox">
								<h3>水表：LYJT-18120700018</h3>
								<ul>
									<li>
										<img src="img/water.png" alt="">
										累计用水量：<span>198.2吨</span>
									</li>
									<li class="noImg">
										上月用水量：<span>20.00吨</span>
									</li>
									<li>
										<img src="img/money.png" alt="">
										应&nbsp;缴&nbsp;金&nbsp;额：<span>12.22元</span>
									</li>
								</ul>
								<button type="button" class="handle" data-toggle="modal" data-target="#myModal2">操作</button>
							</div>
						</li>
						<li>
							<div class="ltBox">
								<img src="img/meter.png" alt="">
								<p class="kouJing">口径：15mm</p>
								<p class="state">状态：<span class="normal">正常</span></p>
							</div>
							<div class="rtBox">
								<h3>水表：LYJT-18120700018</h3>
								<ul>
									<li>
										<img src="img/water.png" alt="">
										累计用水量：<span>198.2吨</span>
									</li>
									<li class="noImg">
										上月用水量：<span>20.00吨</span>
									</li>
									<li>
										<img src="img/money.png" alt="">
										应&nbsp;缴&nbsp;金&nbsp;额：<span>12.22元</span>
									</li>
								</ul>
								<button type="button" class="handle" data-toggle="modal" data-target="#myModal2">操作</button>
							</div>
						</li>
						<li>
							<div class="ltBox">
								<img src="img/meter.png" alt="">
								<p class="kouJing">口径：15mm</p>
								<p class="state">状态：<span class="normal">正常</span></p>
							</div>
							<div class="rtBox">
								<h3>水表：LYJT-18120700018</h3>
								<ul>
									<li>
										<img src="img/water.png" alt="">
										累计用水量：<span>198.2吨</span>
									</li>
									<li class="noImg">
										当期用水量：<span>20.00吨</span>
									</li>
									<li class="noImg">
										剩&nbsp;余&nbsp;水&nbsp;量：<span>11.00吨</span>
									</li>
									<li>
										<img src="img/money.png" alt="">
										当&nbsp;前&nbsp;余&nbsp;额：<span>12.22元</span>
									</li>
								</ul>
								<button type="button" class="handle" data-toggle="modal" data-target="#myModal2">操作</button>
							</div>
						</li>
						<li>
							<div class="ltBox">
								<img src="img/meter.png" alt="">
								<p class="kouJing">口径：15mm</p>
								<p class="state">状态：<span class="abnormal">异常</span></p>
							</div>
							<div class="rtBox">
								<h3>水表：LYJT-18120700018</h3>
								<ul>
									<li>
										<img src="img/water.png" alt="">
										累计用水量：<span>198.2吨</span>
									</li>
									<li class="noImg">
										上月用水量：<span>20.00吨</span>
									</li>
									<li>
										<img src="img/money.png" alt="">
										应&nbsp;缴&nbsp;金&nbsp;额：<span>12.22元</span>
									</li>
								</ul>
								<button type="button" class="handle" data-toggle="modal" data-target="#myModal2">操作</button>
							</div>
						</li>
						<li>
							<div class="ltBox">
								<img src="img/meter.png" alt="">
								<p class="kouJing">口径：15mm</p>
								<p class="state">状态：<span class="offline">离线</span></p>
							</div>
							<div class="rtBox">
								<h3>水表：LYJT-18120700018</h3>
								<ul>
									<li>
										<img src="img/water.png" alt="">
										累计用水量：<span>198.2吨</span>
									</li>
									<li class="noImg">
										上月用水量：<span>20.00吨</span>
									</li>
									<li>
										<img src="img/money.png" alt="">
										应&nbsp;缴&nbsp;金&nbsp;额：<span>12.22元</span>
									</li>
								</ul>
								<button type="button" class="handle" data-toggle="modal" data-target="#myModal2">操作</button>
							</div>
						</li> -->
					</ul>
				</div>
			</div>
		</div>
		<!-- 站点信息 -->
		<div class="modal inmodal" id="myModal" tabindex="-1" role="dialog" data-backdrop="static" aria-hidden="true">
			<div class="modal-dialog">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
						<h4 class="modal-title">站点信息</h4>
					</div>
					<div class="modal-body">
						<div class="form-group">
							<label>站点名称</label>
							<input type="text" placeholder="请输入站点名称" class="form-control zhanDianName">
							<div style="clear:both;"></div>
							<span class="star">*</span>
						</div>
						<div class="form-group">
							<label>站点地址</label>
							<input type="text" placeholder="请输入站点地址" class="form-control zhanDianads">
							<div style="clear:both;"></div>
							<span class="star">*</span>
						</div>
						<div class="form-group">
							<label>客服电话</label>
							<input type="text" placeholder="请输入客服电话" class="form-control keFuTel">
							<div style="clear:both;"></div>
							<span class="star">*</span>
						</div>
						<div class="form-group">
							<label>营业状态</label>
							<select name="account" class="form-control yingYeState">
								<option value="00">请选择操营业状态</option>
								<option value="0">正常营业</option>
								<option value="1">暂停营业</option>
							</select>
							<div style="clear:both;"></div>
							<span class="star">*</span>
						</div>
						<div class="form-group yyTime">
							<label>营业时间</label>
							<div class="date input-append Ym_date2">
								<div class="input-group clockpicker" data-autoclose="true" style="margin-right:110px;">
									<input type="text" class="form-control endtime" value="" placeholder="截止时间">
									<span class="input-group-addon">
										<span class="fa fa-clock-o"></span>
									</span>
								</div>
							</div>
							<span class="line"></span>
							<div class="date input-append Ym_date">
								<div class="input-group clockpicker" data-autoclose="true">
									<input type="text" class="form-control bgtime" value="" placeholder="开始时间">
									<span class="input-group-addon">
										<span class="fa fa-clock-o"></span>
									</span>
								</div>
							</div>
							<div style="clear:both;"></div>
							<span class="star">*</span>
						</div>
						<div class="form-group" style="margin-bottom:0;">
							<label>附件</label>
							<form action="" class="form-horizontal addFileForm">
								<div class="addFile">
									<input type="file" name="flie" class="addImg" value="上传" onchange="verificationPicFile(this)">
									<img class="modulImg" src="img/addBtn.png" alt="">
								</div>
							</form>
							<div style="clear:both;"></div>
							<span class="star">*</span>
						</div>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-primary finishBtn">完成</button>
					</div>
				</div>
			</div>
		</div>
		<!-- 阶梯计价 -->
		<div class="modal inmodal" id="myModal1" tabindex="-1" role="dialog" data-backdrop="static" aria-hidden="true">
			<div class="modal-dialog">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close close2" data-dismiss="modal"><span aria-hidden="true">&times;</span><span
							 class="sr-only">Close</span></button>
						<h4 class="modal-title">水费调价</h4>
					</div>
					<div class="modal-body">
						<div class="form-group">
							<label>计价类型</label>
							<select name="account" class="form-control jiJiaType">
								<option value="01">阶梯计价</option>
								<option value="02">统一计价</option>
							</select>
							<div style="clear:both;"></div>
							<span class="star">*</span>
						</div>
						<div class="form-group tongYi disabledState">
							<label>统一计价</label>
							<input type="text" placeholder="请输入价格" disabled class="form-control tongYiJiJia">
							<div style="clear:both;"></div>
							<span class="star">*</span>
						</div>
						<div class="form-group jieDian">
							<label>第一节点</label>
							<div class="jiJiaBox">
								<input type="text" placeholder="请输入价格" class="form-control firstPrice">
								<span>元/m³</span>
							</div>
							<div style="clear:both;"></div>
							<span class="star">*</span>
						</div>
						<div class="form-group jieDian">
							<label>第二节点</label>
							<div class="jiJiaBox">
								<input type="text" placeholder="请输入价格" class="form-control twicePrice">
								<span>元/m³</span>
							</div>
							<div style="clear:both;"></div>
							<span class="star">*</span>
						</div>
						<div class="form-group jieDian" style="margin-bottom: 0;">
							<label>最大价格</label>
							<div class="jiJiaBox">
								<input type="text" placeholder="请输入价格" class="form-control mostPrice">
								<span>元/m³</span>
							</div>
							<div style="clear:both;"></div>
							<span class="star">*</span>
						</div>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-primary finishBtn2">完成</button>
					</div>
				</div>
			</div>
		</div>
		<!-- 操作 -->
		<div class="modal inmodal" id="myModal2" tabindex="-1" role="dialog" data-backdrop="static" aria-hidden="true">
			<div class="modal-dialog">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close close3" data-dismiss="modal"><span aria-hidden="true">&times;</span><span
							 class="sr-only">Close</span></button>
						<h4 class="modal-title">水表操作</h4>
					</div>
					<div class="modal-body">
						<ul class="caoZuoList">
							<li class="active" data-state="1">开启阀门</li>
							<li data-state="2">关闭阀门</li>
							<li data-state="3" style="margin-bottom: 0;">重启水表</li>
							<li data-state="4" style="margin-bottom: 0;">远程抄表</li>
						</ul>
						<div class="loadingBox">
							<img class="loadImg" src="img/shalou.png" alt="">
							正在<span class="tar">-</span>...
						</div>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-primary finishBtn3">完成</button>
					</div>
				</div>
			</div>
		</div>
		<script src="public/jquery-1.11.3.js"></script>
		<script src="public/bootstrap.min.js" type="text/javascript"></script>
		<!-- <script src="js/plugins/lhgdialog/lhgdialog.js"></script> -->
		<!-- 弹出警示框 -->
		<script src="js/plugins/toastr/toastr.min.js"></script>

		<script src="js/plugins/metisMenu/jquery.metisMenu.js"></script>
		<script src="js/plugins/slimscroll/jquery.slimscroll.min.js"></script>
		<!-- 时间控件样式 -->
		<script src="js/plugins/datetimepicker/bootstrap-datetimepicker.min.js"></script>
		<script src="js/plugins/datetimepicker/bootstrap-datetimepicker-update.min.js"></script>
		<script src="js/plugins/datetimepicker/bootstrap-datetimepicker.zh-CN.js"></script>
		<script src="js/plugins/dataTables/datatables.min.js"></script>
		<!-- 图片旋转 -->
		<script src="public/jquery.rotate.min.js" type="text/javascript" charset="utf-8"></script>
		<!-- Color picker -->
		<script src="js/plugins/colorpicker/bootstrap-colorpicker.min.js"></script>
		<!-- Clock picker -->
		<script src="js/plugins/clockpicker/clockpicker.js"></script>
		<!-- 全局js -->
		<script src="js/global.js" type="text/javascript" charset="utf-8"></script>
		<!-- 引入请求数据方法 -->
		<script src="js/api.js" type="text/javascript" charset="utf-8"></script>
		<script src="js/http.js"></script>
		<script>
			var zdId;
			$(function() {
				$('.clockpicker').clockpicker();
				var currentUrl = window.location.href;
				zdId = currentUrl.split("=")[1];
				GetStationInfo(zdId);
				GetStationWaterPrice(zdId);
				GetStationList(zdId);
			})
			//表单元素获取焦点时取消警示效果
			$("input").focus(function() {
				$(this).parents(".form-group").removeClass("errorIns");
			})
			$("select").focus(function() {
				$(this).parents(".form-group").removeClass("errorIns");
			})
			//关闭模态框的按钮点击事件(清空表单数据)
			$(".close").click(function() {
				$(".form-group").removeClass("errorIns");
				$("input").val("");
				$("select").find("option:eq(0)").prop("selected", true);
				$(".yyTime").removeClass("disabledState");
				$(".yyTime").find("input").prop("disabled", false);
			})
			$(".close2").click(function() {
				$(".form-group").removeClass("disabledState");
				$(".form-group").find("input").prop("disabled", false);
				$(".tongYi").addClass("disabledState");
				$(".tongYi").find("input").prop("disabled", true);
			})
			//新增人员
			$(".addUser").click(function() {
				$(".modal-body").find("input").prop("disabled", false);
				$(".modal-body").find("select").prop("disabled", false);
				$(".modal-body").find("textarea").prop("disabled", false);
				$('.diaTitle').html("新增");
			})
			//列表中的编辑数据按钮
			$(".editBtn").click(function() {
				$(".zhanDianName").val($(".name").html());
				$(".zhanDianads").val($(".address").html());
				$(".keFuTel").val($(".phone").html());
				$(".yingYeState").find('option[value="'+ $(".statusCon").attr("data-state")+'"]').prop("selected",true);
				$(".bgtime").val($(".business_hours").html().split("-")[0]);
				$(".endtime").val($(".business_hours").html().split("-")[1]);
			})
			//提交表单验证(站点信息)   
			$(".finishBtn").click(function() {
				if ($(".zhanDianName").val() == "") {
					$(".zhanDianName").parents(".form-group").addClass("errorIns");
					return false;
				}
				if ($(".zhanDianads").val() == "") {
					$(".zhanDianads").parents(".form-group").addClass("errorIns");
					return false;
				}
				if ($(".keFuTel").val() == "") {
					$(".keFuTel").parents(".form-group").addClass("errorIns");
					return false;
				}
				if ($(".yingYeState").find("option:checked").val() == "00") {
					$(".yingYeState").parents(".form-group").addClass("errorIns");
					return false;
				}
				if ($(".yingYeState").find("option:checked").val() == "01") {
					if ($(".bgtime").val() == "") {
						$(".bgtime").parents(".form-group").addClass("errorIns");
						return false;
					}
					if ($(".endtime").val() == "") {
						$(".endtime").parents(".form-group").addClass("errorIns");
						return false;
					}
				}
				var token = localStorage.getItem("access-token");
				//声明参数对象
				var data = {
					station_id : $(this).attr("data-id"),
					name : $(".zhanDianName").val(),
					address : $(".zhanDianads").val(),
					phone : $(".keFuTel").val(),
					status : $(".yingYeState").find("option:checked").val(),
					business_hours : $(".bgtime").val()+ "-" + $(".endtime").val(),
					photo : $(".modulImg").attr("src")
				};
				//请求回调函数
				var success = function(response) {
					console.log("获取到的获取编辑信息数据：" + JSON.stringify(response));
					if (response.result) {
						toastr.success("编辑成功！");
						GetStationInfo(zdId);
					} else {
						toastr.success(response.message);
					}
				}
				//请求方法
				ajaxFun.post(ApiUrl + global_url.stationEdit, data, token, success);
				$(".close").click(); //关闭弹框
			})
			//提交表单验证(水费调价)   
			$(".finishBtn2").click(function() {
				if ($(".jiJiaType").find("option:checked").val() == "01") { //阶梯计价
					if ($(".firstPrice").val() == "") {
						$(".firstPrice").parents(".form-group").addClass("errorIns");
						return false;
					}
					if ($(".twicePrice").val() == "") {
						$(".twicePrice").parents(".form-group").addClass("errorIns");
						return false;
					}
					if ($(".mostPrice").val() == "") {
						$(".mostPrice").parents(".form-group").addClass("errorIns");
						return false;
					}
				} else if ($(".jiJiaType").find("option:checked").val() == "02") { //统一计价
					if ($(".tongYiJiJia").val() == "") {
						$(".tongYiJiJia").parents(".form-group").addClass("errorIns");
						return false;
					}
				}
				var token = localStorage.getItem("access-token");
				if ($(".jiJiaType").find("option:checked").val() == "01") {
					//声明参数对象
					var data = {
						water_price_id: $(this).attr("data-id"),
						first_order: $(".firstPrice").val(),
						second_order: $(".twicePrice").val(),
						third_order: $(".mostPrice").val()
					};
				} else if ($(".jiJiaType").find("option:checked").val() == "02") {
					//声明参数对象
					var data = {
						water_price_id: $(this).attr("data-id"),
						first_order: $(".tongYiJiJia").val(),
						second_order: $(".tongYiJiJia").val(),
						third_order: $(".tongYiJiJia").val()
					};
				}

				//请求回调函数
				var success = function(response) {
					console.log("获取到的删除角色返回数据：" + JSON.stringify(response));
					if (response.result) {
						toastr.success("删除成功！");
						GetStationWaterPrice(zdId);
					}
				}
				//请求方法
				ajaxFun.post(ApiUrl + global_url.waterPrice, data, token, success);
				$(".close").click(); //关闭弹框
			})
			//选择营业状态
			$(".yingYeState").change(function() {
				if ($(this).find("option:checked").val() == "1") { //营业
					$(".yyTime").removeClass("disabledState");
					$(".yyTime").find("input").prop("disabled", false);
				} else if ($(this).find("option:checked").val() == "0") { //歇业
					$(".yyTime").addClass("disabledState");
					$(".yyTime").find("input").prop("disabled", true);
				}
			})
			//选择计价方式
			$(".jiJiaType").change(function() {
				$(".form-group").removeClass("disabledState");
				$(".form-group").find("input").prop("disabled", false);
				if ($(this).find("option:checked").val() == "01") { //阶梯计价
					$(".tongYi").addClass("disabledState");
					$(".tongYi").find("input").prop("disabled", true);
				} else if ($(this).find("option:checked").val() == "02") { //统一计价
					$(".jieDian").addClass("disabledState");
					$(".jieDian").find("input").prop("disabled", true);
				}
			})
			//操作弹框
			$(".caoZuoList li").click(function() {
				$(this).addClass("active").siblings().removeClass("active");
			})

			$("body").on("click", ".czBtn", function() {
				var id = $(this).attr("data-id");
				$(".finishBtn3").attr("data-id", id);
			})
			//操作
			var angle = 0;
			$(".finishBtn3").click(function() {
				var inner = $(".caoZuoList li.active").html();
				$(".tar").html(inner);
				$(".loadingBox").show();
				var times = setInterval(function() {
					angle += 15;
					$('.loadImg').rotate(angle);
				}, 50);
				var token = localStorage.getItem("access-token");
				//声明参数对象
				var data = {
					equipment_id: $(this).attr("data-id"),
					operate: $(".caoZuoList li.active").attr("data-state")
				};
				//请求回调函数
				var success = function(response) {
					console.log("获取到的获取站点信息数据：" + JSON.stringify(response));
					if (response.result) {
						setTimeout(function() {
							toastr.success("操作成功！");
							window.clearInterval(times);
							$(".loadingBox").hide();
							$(".close").click();
						}, 2000)

					} else {
						toastr.success(response.message);
						setTimeout(function() {
							window.clearInterval(times);
							$(".loadingBox").hide();
						}, 100)
					}
				}
				//请求方法
				ajaxFun.post(ApiUrl + global_url.eqEdit, data, token, success);
			})

			//获取站点信息
			function GetStationInfo(id) {
				var token = localStorage.getItem("access-token");
				//声明参数对象
				var data = {
					station_id: id
				};
				//请求回调函数
				var success = function(response) {
					console.log("获取到的获取站点信息数据：" + JSON.stringify(response));
					if (response.result) {
						for (var k in response.data) {
							$("." + k).html(response.data[k]);
						}
						$(".open_num").html((response.data.open_num + response.data.close_num));
						$(".fault_num").html(response.data.fault_num);
						$(".Off_line_num").html(response.data.Off_line_num);
						$(".statusCon").attr("data-state",response.data.status);
						if (response.data.status == 0) {
							$(".statusCon").html("正常营业");
						} else if (response.data.status == 1) {
							$(".statusCon").html("暂停营业");
						}
					}
				}
				//请求方法
				ajaxFun.post(ApiUrl + global_url.stationInfo, data, token, success);
			}
			//获取站点阶梯水价
			function GetStationWaterPrice(id) {
				var token = localStorage.getItem("access-token");
				//声明参数对象
				var data = {
					station_id: id
				};
				//请求回调函数
				var success = function(response) {
					console.log("获取到的获取站点阶梯水价数据：" + JSON.stringify(response));
					if (response.result) {
						$(".jiJiaType>li").removeClass("show");
						if(response.data.first_order === response.data.second_order&& response.data.first_order === response.data.third_order){
							$(".tongyi").addClass("show");
							$(".tongyi .first_order").html(parseFloat(response.data.first_order).toFixed(2));
						}else{
							$(".jieti").addClass("show");
							for (var k in response.data) {
								$("." + k).html(parseFloat(response.data[k]).toFixed(2));
							}
						}
						
						$(".finishBtn2").attr("data-id", response.data.id);
					}
				}
				//请求方法
				ajaxFun.post(ApiUrl + global_url.stationInfoX, data, token, success);
			}

			function GetStationList(id) {
				var token = localStorage.getItem("access-token");
				//声明参数对象
				var data = {
					station_id: id
				};
				//请求回调函数
				var success = function(response) {
					console.log("获取到的获取站点列表数据：" + JSON.stringify(response));
					if (response.result) {
						$(".meterList").empty();
						var strHtml = '';
						for (var i = 0; i < response.data.data.length; i++) {
							var mData = response.data.data[i];
							strHtml += '<li>';
							strHtml += '<div class="ltBox">';
							strHtml += '	<img src="img/meter.png" alt="">';
							strHtml += '	<p class="kouJing">口径：' + parseInt(mData.caliber).toFixed(2) + 'mm</p>';
							strHtml += '	<p class="state">状态：<span class="' + (mData.status == 1 ? "normal" : "abnormal") + '">' + (mData.status == 1 ? "正常" : "异常") + '</span></p>';
							strHtml += '</div>';
							strHtml += '<div class="rtBox">';
							strHtml += '	<h3>水表：' + mData.number + '</h3>';
							strHtml += '	<ul>';
							strHtml += '		<li>';
							strHtml += '			<img src="img/water.png" alt="">';
							strHtml += '			累计用水量：<span>' + parseFloat(mData.total_water).toFixed(2) + 'm³</span>';
							strHtml += '		</li>';
							if(mData.surplus_water > 0){
								strHtml += '		<li class="noImg">';
								strHtml += '			当期用水量：<span>' + parseFloat(mData.this_month).toFixed(2) + 'm³</span>';
								strHtml += '		</li>';
								strHtml += '		<li class="noImg">';
								strHtml += '			剩&nbsp;余&nbsp;水&nbsp;量：<span>' + parseFloat(mData.surplus_water).toFixed(2) + 'm³</span>';
								strHtml += '		</li>';
								strHtml += '		<li>';
								strHtml += '			<img src="img/money.png" alt="">';
								strHtml += '			当&nbsp;前&nbsp;余&nbsp;额：<span>' + parseFloat(mData.surplus_money).toFixed(2) + '元</span>';
								strHtml += '		</li>';
							}else{
								strHtml += '		<li class="noImg">';
								strHtml += '			上月用水量：<span>' + parseFloat(mData.last_month).toFixed(2) + 'm³</span>';
								strHtml += '		</li>';
								strHtml += '		<li>';
								strHtml += '			<img src="img/money.png" alt="">';
								strHtml += '			应&nbsp;缴&nbsp;金&nbsp;额：<span>' + Math.abs(mData.surplus_money).toFixed(2) + '元</span>';
								strHtml += '		</li>';
							}
							strHtml += '	</ul>';
							strHtml += '	<button type="button" data-id="' + mData.number + '" class="handle diaBtn czBtn" data-toggle="modal" data-target="#myModal2">操作</button>';
							strHtml += '</div>';
							strHtml += '</li>';
						}
						$(".meterList").append(strHtml);
					}
				}
				//请求方法
				ajaxFun.post(ApiUrl + global_url.eqList, data, token, success);
			}
			//图片类型验证
			function verificationPicFile(file) {
				var fileTypes = [".jpg", ".png"];
				var filePath = file.value;
				//当括号里面的值为0、空字符、false 、null 、undefined的时候就相当于false
				if (filePath) {
					var isNext = false;
					var fileEnd = filePath.substring(filePath.indexOf("."));
					for (var i = 0; i < fileTypes.length; i++) {
						if (fileTypes[i] == fileEnd) {
							isNext = true;
							break;
						}
					}
					if (!isNext) {
						alert('不接受此文件类型');
						file.value = "";
						return false;
					}
					//读取图片数据
					var filePic = file.files[0];
					var reader = new FileReader();
					reader.onload = function (e) {
						var data = e.target.result;
						//加载图片获取图片真实宽度和高度
						var image = new Image();
						image.onload=function(){
							var width = image.width;
							var height = image.height;
							if (width == 720 | height == 1280){
								alert("文件尺寸符合！");
							}else {
								alert("文件尺寸应为：720*1280！");
								file.value = "";
								return false;
							}
						};
						$(".modulImg").attr("src",data);
						
					};
					reader.readAsDataURL(filePic);
					
				} else {
					return false;
				}
			}
		</script>
	</body>
</html>
